<?
if (!$PasseParIndex) { header('Location: index.php?Page=Erreur404'); return;}
?>

<table id="Accueil">
<?
if ($ErreurDonnees["Login"]){print("\t<tr>\n\t\t<td><p class=\"ModifError\">".$ErreurDonnees["Login"]."</p></td>\n\t</tr>\n");}
?>
	<tr>
		<td>

<?php
// ============================================================
// Affichage des messages actifs de la page d'accueil
// UNIQUEMENT pour les membres connectés avec pagination
// ============================================================
if (isset($Joueur) && is_object($Joueur)) {
	// Pagination - 2 messages par page
	$messages_par_page = 2;
	$page_msg = isset($_GET['PageMsg']) ? (int)$_GET['PageMsg'] : 1;
	if ($page_msg < 1) $page_msg = 1;

	$offset = ($page_msg - 1) * $messages_par_page;

	// Compter le nombre total de messages actifs
	$query_count = "SELECT COUNT(*) as total FROM NPVB_Messages WHERE is_active = 1";
	$result_count = mysql_query($query_count, $sdblink);
	$total_messages = 0;
	if ($result_count) {
		$row_count = mysql_fetch_object($result_count);
		$total_messages = (int)$row_count->total;
	}

	$total_pages = ceil($total_messages / $messages_par_page);

	// Récupérer les messages de la page courante
	$query_messages = "SELECT * FROM NPVB_Messages WHERE is_active = 1 ORDER BY created_at DESC LIMIT $offset, $messages_par_page";
	$result_messages = mysql_query($query_messages, $sdblink);

	if ($result_messages && mysql_num_rows($result_messages) > 0) {
?>
	<div style="background: #f5f5f5; border: 2px solid #cccccc; border-radius: 5px; padding: 15px; margin-bottom: 20px;">
		<h3 style="margin-top: 0; color: #333333; border-bottom: 2px solid #999999; padding-bottom: 10px;">
			